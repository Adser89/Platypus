Platypus Variant-Calling Algorithm

Platypus (http://www.well.ox.ac.uk/platypus) is a haplotype-based variant
caller. The program integrates the calling of SNP and indel variants of
up to 50 bp, using a 3-step process. First, candidates for SNP and indel
polymorphisms are generated from the input reads from all population
samples and their alignment to the reference sequence. Second, haplotypes
are generated from sets of these candidate variants restricted to small
windows, and all reads are re-aligned to these haplotypes. Third, an EM
algorithm estimates the frequencies of the haplotypes in the population, and
determines which haplotypes are supported by the data; the set of haplotypes
that have support determine the variants that are reported to be segregating
in the population.

Several filtering steps improve the robustness of calls and reduce the number
of spurious candidates. To remove poorly or ambiguously mapped reads,
Platpyus requires a minimum mapping quality of 20 on the Phred scale. To reduce the
impact of non-independent errors, duplicate reads are removed.

Variant candidates are considered by Platypus if they are seen at least twice.
For SNPs, the variant base must be seen at least twice with base-quality
exceeding 20. Indel candidates are left-normalised. Platypus then looks in
small (~100-200 base) windows across the genome, and creates haplotype
candidates, based on the list of variants in each window. Each haplotype may
contain several variants. As the number of possible haplotypes is generally
exponential in the number of candidate variants, the program adapts the
window size and implements some heuristic filters to limit the number of
haplotypes that are considered to 256.

An EM algorithm is used to infer the population frequency of each haplotype
in the data provided. This algorithm, which includes priors for SNP and
indels, and a model for genotype frequencies given the frequencies of
variants, works by re-aligning all the reads to each of the haplotypes, and
computing a likelihood for each read given each possible diploid genotype.
The algorithm used to calculate these genotype likelihoods includes a model
for indel errors in Illumina reads, similar to the model used by Dindel [ref]
. Platypus uses the inferred frequencies and the likelihoods to compute
a probability for each variant candidate segregating in the data. These
probabilities are reported in the VCF output file.

Finally the variants are filtered, to reduce the false-positive rate. First, variants
are only called if they have a high enough posterior probability (Phred score
exceeding 5). Additional filters are used to remove variants which are only 
supported by low-quality reads, or reads on the forward or reverse strand.
